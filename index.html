<!DOCTYPE html>
<html>

<head>
    <meta name="screen-orientation" content="portrait">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
    <title>FIT_TE</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/wall.css">
    <style type="text/css">
        body,
        html {
            width: 100%;
            height: 100%;
        }

        .alert-mask {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
        }

        .winner {
            display: inline-block;
            margin: 10px;
            text-align: center;
            color: #000;
        }

        .winner img {
            width: 15vw;
            /* 15% chi·ªÅu r·ªông m√†n h√¨nh */
            height: 15vw;
            max-width: 160px;
            /* kh√¥ng qu√° l·ªõn */
            max-height: 160px;
            border-radius: 50%;
            border: 3px solid #ff9800;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .winner-item {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 25px;
            color: #000;
            margin: 5px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.8);
            padding: 10px;
        }


        .alert-box {
            background: #fff;
            padding: 20px 30px;
            border-radius: 12px;
            text-align: center;
            min-width: 260px;
        }

        .alert-box h3 {
            margin-bottom: 10px;
            color: #e53935;
        }

        .alert-box button {
            margin-top: 15px;
            padding: 6px 20px;
            border: none;
            background: #2196f3;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
        }

        .result {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            /* x·∫øp h√†ng */
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            pointer-events: auto;
            overflow: auto;
            gap: 15px;
            /* kho·∫£ng c√°ch gi·ªØa c√°c h√†ng */
        }

        .result .row {
            display: flex;
            justify-content: center;
            /* cƒÉn gi·ªØa t·ª´ng h√†ng */
            gap: 15px;
            /* kho·∫£ng c√°ch gi·ªØa t·ª´ng ng∆∞·ªùi trong h√†ng */
        }

        .result .winner {
            display: flex;
            flex-direction: column;
            align-items: center;
        }







        /* ===== TRANG CH·ª¶ ===== */
        #home-screen {
            position: fixed;
            inset: 0;
            z-index: 9999;

        }

        #home-screen img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: inherit;
        }


        .lottery-controls .pure-button {
            width: 170px;
            height: 85px;
            border-radius: 16px;
            border: none;
            color: #fff;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
            transition: all 0.25s ease;
        }

        #myCanvas {
            /* display: block; */
        }


        /* Text */
        .lottery-controls .vi {
            display: block;
            font-size: 18px;
            font-weight: bold;
        }

        .lottery-controls .cn {
            display: block;
            font-size: 14px;
            opacity: 0.85;
        }

        /* M√†u */
        .lottery-controls .btn-start {
            background: linear-gradient(135deg, #ff5722, #ff9800);
        }

        .lottery-controls .btn-stop {
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
        }

        .lottery-controls .btn-reset {
            background: linear-gradient(135deg, #2196f3, #03a9f4);
        }

        /* Disable */
        .lottery-controls .pure-button:disabled {
            background: #9e9e9e;
            cursor: not-allowed;
            box-shadow: none;
        }


        .result span {
            display: inline-block;
            font-size: 25px;
            width: 170px;
            background: #fff;
            /* line-height: 30px; */
            color: #000;
            margin: 5px;
            border-radius: 10px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.8);
            padding: 10px 10px;
        }

        button,
        input,
        optgroup,
        select,
        textarea {
            color: inherit;
            font: inherit;
            margin: 0;
            border: none;
        }

        button {
            overflow: visible;
        }

        button,
        select {
            text-transform: none;
        }

        button,
        html input[type=button],
        input[type=reset],
        input[type=submit] {
            -webkit-appearance: button;
            cursor: pointer;
        }

        .pure-button {
            display: inline-block;
            zoom: 1;
            line-height: normal;
            white-space: nowrap;
            vertical-align: middle;
            text-align: center;
            cursor: pointer;
            -webkit-user-drag: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }

        .pure-button {
            font-family: inherit;
            font-size: 100%;
            padding: .5em 1em;
            color: #444;
            color: rgba(0, 0, 0, .8);
            border: 0 rgba(0, 0, 0, 0);
            background-color: #E6E6E6;
            text-decoration: none;
            border-radius: 15px;
        }

        .pure-button:focus {
            outline: 0
        }

        .pure-button-hover,
        .pure-button:hover,
        .pure-button:focus {
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#1a000000', GradientType=0);
            background-image: -webkit-gradient(linear, 0 0, 0 100%, from(transparent), color-stop(40%, rgba(0, 0, 0, .05)), to(rgba(0, 0, 0, .1)));
            background-image: -webkit-linear-gradient(transparent, rgba(0, 0, 0, .05) 40%, rgba(0, 0, 0, .1));
            background-image: -moz-linear-gradient(top, rgba(0, 0, 0, .05) 0, rgba(0, 0, 0, .1));
            background-image: -o-linear-gradient(transparent, rgba(0, 0, 0, .05) 40%, rgba(0, 0, 0, .1));
            background-image: linear-gradient(transparent, rgba(0, 0, 0, .05) 40%, rgba(0, 0, 0, .1));
        }

        .button-success,
        .button-error,
        .button-warning,
        .button-secondary {
            color: white;
            border-radius: 4px;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
        }

        .button-success {
            background: rgb(28, 184, 65);
        }

        .button-error {
            background: rgb(202, 60, 60);
        }

        .button-warning {
            background: rgb(223, 117, 20);
        }

        .button-secondary {
            background: rgb(66, 184, 221);
        }

        .tools {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;

            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            gap: 20px;
        }

        /* B√äN TR√ÅI */
        .tools-left {
            display: flex;
            /* gap: 10px; */
            flex-wrap: wrap;
            max-width: 65%;
        }

        /* B√äN PH·∫¢I */
        .tools-right {
            display: flex;
            flex-direction: inherit;
            gap: 12px;
            align-items: center;
        }

        /* =========================
   FIX HOVER B·ªä M·ªú N√öT CH√çNH
   ========================= */

        /* Ghi ƒë√® hover m·∫∑c ƒë·ªãnh c·ªßa pure-button */
        .lottery-controls .pure-button:hover,
        .lottery-controls .pure-button:focus {
            background-image: none !important;
            filter: none !important;
            opacity: 1 !important;
            transform: translateY(-2px) scale(1.03);
        }

        /* Hi·ªáu ·ª©ng s√°ng theo t·ª´ng n√∫t */
        .lottery-controls .btn-start:hover {
            box-shadow: 0 0 20px rgba(255, 152, 0, 0.9);
        }

        .lottery-controls .btn-stop:hover {
            box-shadow: 0 0 20px rgba(211, 47, 47, 0.9);
        }

        .lottery-controls .btn-reset:hover {
            box-shadow: 0 0 20px rgba(3, 169, 244, 0.9);
        }



        .tools .pure-button {
            display: inline-block;
            margin: 5px;
            /* padding: 10px 0; */
            text-align: center;
            width: 150px;
            font-size: 13px;
        }

        .mask {
            -webkit-filter: blur(5px);
            filter: blur(5px);
        }

        #main {
            position: relative;
            width: 100%;
            height: 100%;

            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-btn {
            position: fixed;
            top: 25px;
            right: 1px;
            z-index: 20000;
        }

        .home-btn {
            display: none;
            position: fixed;
            top: 5px;
            right: 1px;
            z-index: 20000;
        }

        #currentDate {
            position: fixed;
            bottom: clamp(90px, 10vh, 105px);
            left: 50%;
            transform: translateX(-50%);
            z-index: 25000;

            /* --- Ki·ªÉu ch·ªØ Bold & Serif --- */
            font-family: "Times New Roman", Times, serif;
            font-size: 27px;
            /* TƒÉng nh·∫π k√≠ch th∆∞·ªõc */
            font-weight: 800;
            /* ƒê·ªô ƒë·∫≠m cao nh·∫•t */
            letter-spacing: 2px;
            /* Gi√£n ch·ªØ cho tho√°ng gi·ªëng ti√™u ƒë·ªÅ */
            text-transform: uppercase;
            /* Vi·∫øt hoa ƒë·ªÉ ƒë·ªìng b·ªô ho√†n to√†n */

            /* --- M√†u s·∫Øc & Hi·ªáu ·ª©ng --- */
            color: #FFFFFF;
            background: transparent;
            /* B·ªè n·ªÅn ƒë·ªÉ c√πng t√¥ng v·ªõi ·∫£nh */

            /* ƒê·ªï b√≥ng ƒë·∫≠m ƒë·ªÉ ch·ªØ n·ªïi kh·ªëi tr√™n n·ªÅn xanh */
            text-shadow:
                2px 2px 4px rgba(0, 0, 0, 0.7),
                0px 0px 10px rgba(255, 255, 255, 0.2);

            user-select: none;
            white-space: nowrap;
        }
    </style>
</head>

<body>
    <!-- ===== TRANG CH·ª¶ ===== -->
    <div id="home-screen">
        <img src="img/home.png">
    </div>



    <div id="customAlert" class="alert-mask" style="display:none">
        <div class="alert-box">
            <h3>Th√¥ng b√°o</h3>
            <p>Gi·∫£i n√†y ƒë√£ quay xongÔºÅ<br>ËØ•Â•ñÈ°πÂ∑≤ÊäΩÂÆåÔºÅ</p>
            <button onclick="closeAlert()">OK</button>
        </div>
    </div>

    <div id="customResetAlert" class="alert-mask" style="display:none">
        <div class="alert-box">
            <h3>Th√¥ng b√°o</h3>
            <p style="font-size:18px; font-weight:bold;">
                B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën c√†i l·∫°i kh√¥ng?<br>
                <span style="font-size:14px; font-weight:normal;">
                    Á°ÆÂÆöË¶ÅÈáçÁΩÆ‰πàÔºü
                </span><br>
                T·∫•t c·∫£ l·ªãch s·ª≠ quay tr∆∞·ªõc ƒë√≥ s·∫Ω b·ªã x√≥a!
            </p>
            <button onclick="confirmReset()">OK</button>
            <button onclick="closeResetAlert()" style="margin-left:10px;">H·ªßy</button>
        </div>
    </div>
    <!-- Th√™m nh·∫°c n·ªÅn t·∫°i ƒë√¢y -->
    <audio id="bgMusic" src="audio/tatNien2024(30s).mp3" loop></audio>


    <div id="main" class="wall">

    </div>
    <div id="result" class="result">
    </div>
    <div id="tools" class="tools">
        <!-- B√äN TR√ÅI: C√ÅC GI·∫¢I -->
        <div class="tools-left">
            <button v-for="(item, index) in btns" @click="onClick(item, index)" class="pure-button"
                :disabled="item.done" :class="{ 'button-error': selectedIndex === index,
                  'button-secondary': item.done }" style="line-height:1.2;width: 160px;padding:3px 0;">
                <div style="font-size:13px;font-weight:bold">{{ item.label }}</div>
                <div style="font-size:11px;color:#444">{{ item.cn }}</div>
                <div style="font-size:10px;margin-top:2px">
                    {{ item.done ? 0 : item.value }}
                </div>
            </button>
        </div>

        <!-- B√äN PH·∫¢I: N√öT ƒêI·ªÄU KHI·ªÇN -->
        <div class="tools-right lottery-controls">
            <button class="pure-button btn-main" @click.stop="toggle" :class="running ? 'btn-stop' : 'btn-start'">
                <span class="vi">{{ running ? 'D·ª™NG' : 'B·∫ÆT ƒê·∫¶U' }}</span>
                <span class="cn">{{ running ? 'ÂÅúÊ≠¢' : 'ÂºÄÂßã' }}</span>
            </button>

            <button class="pure-button btn-reset" @click.stop="showResetAlert">
                <span class="vi">C√ÄI L·∫†I</span>
                <span class="cn">ÈáçÁΩÆ</span>
            </button>


        </div>
    </div>

    <script type="text/javascript" src="js/zepto.js"></script>
    <script type="text/javascript" src="js/vue.js"></script>
    <script type="text/javascript" src="js/tagcanvas.js"></script>
    <script type="text/javascript" src="js/member.js"></script>
    <script>
        var needConfirm = false;
    </script>

    <script>
        document.addEventListener('keydown', function (e) {
            if (e.code === 'Enter' || e.code === 'Space') {
                e.preventDefault();
                const homeBtn = document.querySelector('.home-btn');
                if (homeBtn) {
                    homeBtn.style.display = 'flex'; // tr√°nh page scroll
                }
                currentDate.style.display = 'none';

                const home = document.getElementById('home-screen');
                if (home && home.style.display !== 'none') {
                    home.style.display = 'none';
                    return;
                }
                window.appVue.toggle();                   // ‚òÖ g·ªçi chung 1 h√†m
            }
        });


    </script>


    <script type="text/javascript">
        (function () {
            var choosed = JSON.parse(localStorage.getItem('choosed')) || {};
            var bgMusic = document.getElementById('bgMusic'); // üéµ nh·∫°c n·ªÅn
            var isToggling = false;

            console.log(choosed);
            var speed = function () {
                return [0.1 * Math.random() + 0.01, -(0.1 * Math.random() + 0.01)];
            };
            var getKey = function (item) {
                return item.name + '-' + item.phone;
            };
            var createHTML = function () {
                var html = ['<ul>'];
                member.forEach(function (item, index) {
                    item.index = index;
                    var key = getKey(item);
                    var color = choosed[key] ? 'yellow' : 'white';
                    html.push('<li><a href="#" style="color: ' + color + ';">' + item.name + '</a></li>');
                });
                html.push('</ul>');
                return html.join('');
            };
            // var lottery = function (count) {
            //     var list = canvas.getElementsByTagName('a');
            //     var color = 'yellow';
            //     var ret = member
            //         .filter(function (m, index) {
            //             m.index = index;
            //             return !choosed[getKey(m)];
            //         })
            //         .map(function (m) {
            //             return Object.assign({
            //                 score: Math.random()
            //             }, m);
            //         })
            //         .sort(function (a, b) {
            //             return a.score - b.score;
            //         })
            //         .slice(0, count)
            //         .map(function (m) {
            //             choosed[getKey(m)] = 1;
            //             list[m.index].style.color = color;
            //             return m.name + '<br/>' + m.phone;
            //         });
            //     localStorage.setItem('choosed', JSON.stringify(choosed));
            //     return ret;
            // };
            //tuanlg

            var lottery = function (count) {
                var list = canvas.getElementsByTagName('a');
                var color = 'yellow';

                var remaining = member.filter(m => !choosed[getKey(m)]);

                var ret = remaining
                    .map(m => Object.assign({ score: Math.random() }, m))
                    .sort((a, b) => a.score - b.score)
                    .slice(0, count)
                    .map(m => {
                        choosed[getKey(m)] = 1;
                        list[m.index].style.color = color;

                        // t·ª± t·∫°o ƒë∆∞·ªùng d·∫´n ·∫£nh theo phone
                        m.photo = 'img/users/' + m.phone + '.jpg'; // ·∫£nh ch√≠nh

                        return m;
                    });

                localStorage.setItem('choosed', JSON.stringify(choosed));
                return ret;
            };




            var canvas = document.createElement('canvas');
            canvas.id = 'myCanvas';
            canvas.width = document.body.offsetWidth;
            canvas.height = document.body.offsetHeight;

            document.getElementById('main').appendChild(canvas);
            function renderWinners(ret) {
                let html = '';
                let perRow = 5; // m·∫∑c ƒë·ªãnh 5 ng∆∞·ªùi/1 h√†ng

                // C·∫≠p nh·∫≠t s·ªë ng∆∞·ªùi/1 h√†ng theo y√™u c·∫ßu
                if (ret.length === 1) perRow = 1;
                else if (ret.length === 5) perRow = 5;
                else if (ret.length === 10) perRow = 5;
                else if (ret.length === 20) perRow = 7;

                for (let i = 0; i < ret.length; i += perRow) {
                    let rowItems = ret.slice(i, i + perRow);
                    html += `<div class="row" style="display:flex; justify-content:center; margin-bottom:15px;">`;

                    rowItems.forEach(m => {
                        html += `
            <div class="winner" style=" text-align:center; ">
                <img src="${m.photo}" 
                     onerror="this.onerror=null;this.src='img/users/noImage.jpg';" 
                     style="width:120px; height:120px; border-radius:50%; border:3px solid #ff9800; box-shadow:0 4px 10px rgba(0,0,0,0.5);">
                <span style="display:block; font-weight:bold;padding: 4px 10px; font-size:16px; margin-top:5px;">
                    ${m.name}<br>
                    <span class="msnv" style="color:red;padding: 4px 10px; font-size:14px;    box-shadow: 0 0 0 rgba(0, 0, 0, 0);
    margin: 0 0 0 -10px;">${m.phone}</span>
                </span>
            </div>`;
                    });

                    html += '</div>';
                }

                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                $('#result').css({
                    'display': 'flex',
                    'flex-direction': 'column',
                    'align-items': 'center'
                }).html(html);

                // Th√™m hi·ªáu ·ª©ng ph√°o hoa
                createConfetti();
                html += `
<div style="margin-top:0px;">
    <button class="pure-button btn-reset"
        style="width:200px;height:60px;font-size:18px;"
        onclick="confirmResult()">Á°ÆËÆ§
    </button>
</div>
`;
                // üîΩ D√íNG N√ÄY PH·∫¢I L√Ä CU·ªêI
                $('#result').html(html).show();
                $('#main').addClass('mask');
                needConfirm = true; // üîí kh√≥a quay

            }

            function createConfetti() {
                // Burst ch√≠nh t·ª´ gi·ªØa
                confetti({
                    particleCount: 200,
                    spread: 90,
                    origin: { y: 0.6, x: 0.5 },
                    colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#800080', '#ffc0cb', '#a52a2a'],
                    scalar: 1.5
                });

                // Burst t·ª´ tr√°i
                setTimeout(() => {
                    confetti({
                        particleCount: 100,
                        angle: 60,
                        spread: 70,
                        origin: { x: 0, y: 0.5 },
                        colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#800080', '#ffc0cb', '#a52a2a'],
                        scalar: 1.5
                    });
                }, 200);

                // Burst t·ª´ ph·∫£i
                setTimeout(() => {
                    confetti({
                        particleCount: 100,
                        angle: 120,
                        spread: 70,
                        origin: { x: 1, y: 0.5 },
                        colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffa500', '#800080', '#ffc0cb', '#a52a2a'],
                        scalar: 1.5
                    });
                }, 400);
            }


            window.appVue = new Vue({
                el: '#tools',
                data: {
                    selected: 1,
                    selectedIndex: null,   // üëà th√™m d√≤ng n√†y
                    running: false,
                    showResult: false,
                    currentPrizeIndex: 0, // Gi·∫£i hi·ªán t·∫°i ƒëang ch·ªù quay
                    highlightInterval: null,
                    btns: [
                        { label: 'GI·∫¢I KHUY·∫æN KH√çCH', cn: 'ÈºìÂä±Â•ñ', value: 20, done: false },
                        { label: 'GI·∫¢I BA', cn: '‰∏âÁ≠âÂ•ñ', value: 10, done: false },
                        { label: 'GI·∫¢I NH√å', cn: '‰∫åÁ≠âÂ•ñ', value: 10, done: false },

                        { label: 'GI·∫¢I NH·∫§T', cn: '‰∏ÄÁ≠âÂ•ñ', value: 5, done: false },
                        { label: 'GI·∫¢I KH√çCH L·ªÜ BU', cn: 'ÈºìÂä±Â•ñ', value: 10, done: false }
                    ]
                }
                ,
                mounted() {
                    canvas.innerHTML = createHTML();
                    TagCanvas.Start('myCanvas', '', {
                        textColour: null,
                        initial: speed(),
                        dragControl: 1,
                        textHeight: 14
                    });
                },
                methods: {
                    showResetAlert: function () {
                        showResetAlert();
                    },
                    onClick: function (item, index) {
                        if (item.done) return;

                        $('#result').css('display', 'none');
                        if (needConfirm) {
    document.getElementById('restoreResultBtn').style.display = 'block';
}
                        $('#main').removeClass('mask');

                        this.selected = item.value;
                        this.selectedIndex = index;
                    }

                    ,
                    toggle: function () {
                        if (needConfirm) return;
                        if (isToggling) return;          // ‚òÖ kh√≥a tr√πng l·∫∑p
                        isToggling = true;               // ‚òÖ g·∫°t c√¥ng t·∫Øc

                        // N·∫øu ch∆∞a ch·ªçn gi·∫£i n√†o, m·∫∑c ƒë·ªãnh 1 ng∆∞·ªùi
                        if (!this.running && this.selected === 0) {
                            this.selected = 1;
                            this.selectedIndex = null;
                        }

                        if (this.running) {
                            /* ==== D·ª™NG QUAY (gi·ªØ nguy√™n code c≈©) ==== */
                            TagCanvas.SetSpeed('myCanvas', speed());
                            bgMusic.pause();
                            var ret = lottery(this.selected);

                            if (this.selectedIndex !== null) {
                                this.btns[this.selectedIndex].done = true;
                                this.btns[this.selectedIndex].value = 0;
                                this.selected = 0;
                            }
                            if (ret.length === 0) {
                                $('#result').css('display', 'block').html(
                                    '<span style="    width: 250px;">' +
                                    '<b style="font-size:32px;color:#d32f2f">ƒê√£ h·∫øt ng∆∞·ªùi</b><br>' +
                                    '<small style="font-size:20px;color:#555">Â∑≤ÊäΩÂÆå</small>' +
                                    '</span>'
                                );
                                this.running = false;
                                isToggling = false;
                                return;
                            }
                            renderWinners(ret);
                            this.showResult = true;
                            TagCanvas.Reload('myCanvas');
                            setTimeout(() => {
                                var prizeLabel = this.selectedIndex !== null ? this.btns[this.selectedIndex].label : "GI·∫¢I PH·∫¶N TH∆Ø·ªûNG";
                                var winners = ret.map(item => [item.name, item.phone]);
                                localStorage.setItem(new Date().toString(), JSON.stringify({ prize: prizeLabel, winners: winners }));
                                $('#main').addClass('mask');
                            }, 300);
                        } else {
                            /* ==== B·∫ÆT ƒê·∫¶U QUAY (gi·ªØ nguy√™n code c≈©) ==== */
                            $('#result').css('display', 'none');
                            if (needConfirm) {
    document.getElementById('restoreResultBtn').style.display = 'block';
}
                            $('#main').removeClass('mask');
                            var list = canvas.getElementsByTagName('a');
                            var i = 0;
                            var interval = setInterval(() => {
                                list.forEach(a => a.style.color = 'white');
                                list[i % list.length].style.color = 'orange';
                                i++;
                            }, 50);
                            bgMusic.currentTime = 0;
                            bgMusic.play();
                            this.highlightInterval = interval;
                            TagCanvas.SetSpeed('myCanvas', [5, 1]);
                        }

                        this.running = !this.running;
                        isToggling = false;              // ‚òÖ m·ªü kh√≥a
                    }
                }
            });
        })();
    </script>
    <!-- <script>
        document.addEventListener('click', function (e) {
            const result = document.getElementById('result');
            const tools = document.getElementById('tools');
            const main = document.getElementById('main');

            // L·∫•y computed style c·ªßa result
            const style = window.getComputedStyle(result);
            if (style.display !== 'none') {
                // N·∫øu click kh√¥ng n·∫±m trong v√πng n√∫t ƒëi·ªÅu khi·ªÉn
                if (!tools.contains(e.target)) {
                    // ·∫®n k·∫øt qu·∫£
                    result.style.display = 'none';
                    // B·ªè mask v√† hi·ªán m√†n h√¨nh ch√≠nh
                    main.classList.remove('mask');

                    // N·∫øu mu·ªën reset canvas / m√†n h√¨nh TagCanvas v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu
                    TagCanvas.Reload('myCanvas');
                }
            }
        });

    </script> -->
    <script>
document.addEventListener('click', function (e) {
    const result = document.getElementById('result');
    const tools = document.getElementById('tools');
    const main = document.getElementById('main');

    if (!result) return;

    const style = window.getComputedStyle(result);

    // Ch·ªâ x·ª≠ l√Ω khi k·∫øt qu·∫£ ƒëang hi·ªán
    if (style.display !== 'none') {

        // üö´ ƒêANG CH·ªú X√ÅC NH·∫¨N ‚Üí KH√îNG CHO ·∫®N
        if (typeof needConfirm !== 'undefined' && needConfirm) return;

        // ‚úÖ Click ngo√†i tools + ngo√†i result m·ªõi ·∫©n
        if (!tools.contains(e.target) && !result.contains(e.target)) {
            result.style.display = 'none';
            main.classList.remove('mask');

            // Reset canvas v·ªÅ tr·∫°ng th√°i quay
            if (window.TagCanvas) {
                TagCanvas.Reload('myCanvas');
            }
        }
    }
});
</script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {

            function updateDate() {
                const now = new Date();
                const day = String(now.getDate()).padStart(2, '0');
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const year = now.getFullYear();

                const el = document.getElementById('currentDate');
                if (el) {
                    el.innerText = `${day}-${month}-${year}`;
                }
            }

            updateDate();
            setInterval(updateDate, 1000);
        });
    </script>

    <script>
        function showAlert() {
            document.getElementById('customAlert').style.display = 'flex';
        }

        function closeAlert() {
            document.getElementById('customAlert').style.display = 'none';
        }
        function showResetAlert() {
            document.getElementById('customResetAlert').style.display = 'flex';
        }
        function closeResetAlert() {
            document.getElementById('customResetAlert').style.display = 'none';
        }
        function confirmReset() {
            localStorage.clear();
            location.reload(true);
        }
        function showHome() {
            document.getElementById('home-screen').style.display = 'block';
            const date = document.getElementById('currentDate');
            if (date) {
                date.style.display = 'block';
            }

        }
    </script>
    <script>
        function confirmResult() {
            document.getElementById('result').style.display = 'none';
            document.getElementById('main').classList.remove('mask');
                document.getElementById('restoreResultBtn').style.display = 'none';

            window.appVue.running = false;

            needConfirm = false;   // ‚úÖ M·ªû KH√ìA
        }
    </script>
    <script>
function restoreResult() {
    const result = document.getElementById('result');
    const main = document.getElementById('main');
    const btn = document.getElementById('restoreResultBtn');

    if (!needConfirm) return;

    result.style.display = 'flex';
    main.classList.add('mask');
    btn.style.display = 'none';
}
</script>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- LINK XEM K·∫æT QU·∫¢ -->
    <div class="result-btn">
        <a href="./result.html" target="_blank">Ëé∑Â•ñÂêçÂçï</a>
    </div>
    <div id="currentDate"></div>
    <!-- N√öT V·ªÄ HOME -->
    <div class="home-btn">
        <a href="#" onclick="showHome()">È¶ñÈ°µ</a>
    </div>

<div id="restoreResultBtn"
     style="
        display:none;
        position:fixed;
        bottom:140px;
        right:20px;
        z-index:30000;
     ">
    <button class="pure-button button-secondary"
            style="font-size:12px;padding:6px 10px;border-radius:20px;"
            onclick="restoreResult()">
        üìÑ Xem k·∫øt qu·∫£<br>
        Êü•ÁúãÁªìÊûú
    </button>
</div>

</body>

</html>